<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0f172a" id="theme-color-meta">
    
    <link rel="manifest" href='data:application/manifest+json,{"name":"VibeBudget","short_name":"VibeBudget","start_url":".","display":"standalone","background_color":"#0f172a","theme_color":"#0f172a","icons":[{"src":"https://fav.farm/ðŸ’Ž","sizes":"192x192","type":"image/png"}]}'>

    <title>VibeBudget Elite</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" href="https://fav.farm/ðŸ’Ž" />
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;700&display=swap');
        body { transition: background-color 1s ease; font-family: 'Inter', sans-serif; overflow-x: hidden; margin: 0; background-color: #0f172a; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 2.5rem; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 text-slate-100">

    <div class="w-full max-w-md space-y-6">
        <div class="text-center">
            <div class="flex justify-between items-center px-4 mb-4">
                <button onclick="setNewLimit()" class="text-[10px] uppercase tracking-[0.3em] text-slate-400 bg-white/5 px-3 py-1 rounded-full">Limit</button>
                <button onclick="exportCSV()" class="text-[10px] uppercase tracking-[0.3em] text-slate-400 bg-white/5 px-3 py-1 rounded-full">CSV Export</button>
            </div>
            <div id="remaining" class="text-7xl font-thin tracking-tighter drop-shadow-2xl">â‚¬0.00</div>
            <div id="daily-vibe" class="mt-3 text-xs font-light tracking-widest uppercase opacity-80">Berechne...</div>
        </div>

        <div class="glass p-5 shadow-2xl">
            <canvas id="budgetChart" height="180"></canvas>
        </div>

        <div class="glass p-2 flex items-center gap-2 pr-2">
            <input type="number" id="amount" inputmode="decimal" placeholder="0.00" 
                class="flex-1 bg-transparent text-2xl p-4 outline-none border-none focus:ring-0 text-white font-light">
            <button onclick="addExpense()" id="action-btn"
                class="bg-emerald-500 text-slate-900 w-14 h-14 rounded-2xl font-bold text-3xl flex items-center justify-center active:scale-75 shadow-lg">âˆ’</button>
        </div>

        <div id="history" class="flex gap-4 overflow-x-auto p-2 no-scrollbar"></div>
    </div>

    <script>
        let state = JSON.parse(localStorage.getItem('vibeBudgetData') || '{"limit":200,"remaining":200,"history":[],"chartData":[200]}');
        let chart;

        function initChart() {
            const ctx = document.getElementById('budgetChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: state.chartData.map((_, i) => i),
                    datasets: [{
                        data: state.chartData,
                        borderColor: '#ffffff',
                        borderWidth: 4,
                        tension: 0.4,
                        pointRadius: 0,
                        fill: true,
                        backgroundColor: 'rgba(255,255,255,0.05)'
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
            });
        }

        function render() {
            document.getElementById('remaining').innerText = `â‚¬${state.remaining.toFixed(2)}`;
            const daysLeft = 8 - (new Date().getDay() || 7);
            document.getElementById('daily-vibe').innerText = `â‚¬${(state.remaining / daysLeft).toFixed(2)} pro Tag verfÃ¼gbar`;
            
            chart.data.labels = state.chartData.map((_, i) => i);
            chart.data.datasets[0].data = state.chartData;
            chart.update();
            localStorage.setItem('vibeBudgetData', JSON.stringify(state));
        }

        function addExpense() {
            const input = document.getElementById('amount');
            const val = parseFloat(input.value);
            if (val > 0
